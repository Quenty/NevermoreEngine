"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[41093],{47565:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>t,default:()=>h,frontMatter:()=>l,metadata:()=>o,toc:()=>a});const o=JSON.parse('{"id":"gotchas/troubleshooting","title":"Troubleshooting","description":"Common setup and development issues and how to resolve them.","source":"@site/docs/gotchas/troubleshooting.md","sourceDirName":"gotchas","slug":"/gotchas/troubleshooting","permalink":"/NevermoreEngine/docs/gotchas/troubleshooting","draft":false,"unlisted":false,"editUrl":"https://github.com/Quenty/NevermoreEngine/edit/main/docs/gotchas/troubleshooting.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"Troubleshooting","sidebar_position":2},"sidebar":"defaultSidebar","previous":{"title":"Tooling Gotchas","permalink":"/NevermoreEngine/docs/gotchas/tooling"}}');var i=s(74848),r=s(28453);const l={title:"Troubleshooting",sidebar_position:2},t="Troubleshooting",d={},a=[{value:"Setup",id:"setup",level:2},{value:"<code>pnpm install</code> fails or npm/yarn is rejected",id:"pnpm-install-fails-or-npmyarn-is-rejected",level:3},{value:"Aftman tools not found after install",id:"aftman-tools-not-found-after-install",level:3},{value:"Luau-LSP not working in VS Code",id:"luau-lsp-not-working-in-vs-code",level:3},{value:"Linting",id:"linting",level:2},{value:"<code>lint:luau</code> errors about missing sourcemap",id:"lintluau-errors-about-missing-sourcemap",level:3},{value:"Linting hangs or uses excessive memory",id:"linting-hangs-or-uses-excessive-memory",level:3},{value:"Testing",id:"testing",level:2},{value:"Cloud tests fail with authentication errors",id:"cloud-tests-fail-with-authentication-errors",level:3},{value:"Tests pass locally but fail in CI",id:"tests-pass-locally-but-fail-in-ci",level:3},{value:"Rojo",id:"rojo",level:2},{value:"Rojo build errors or missing modules",id:"rojo-build-errors-or-missing-modules",level:3}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"troubleshooting",children:"Troubleshooting"})}),"\n",(0,i.jsx)(n.p,{children:"Common setup and development issues and how to resolve them."}),"\n",(0,i.jsx)(n.h2,{id:"setup",children:"Setup"}),"\n",(0,i.jsxs)(n.h3,{id:"pnpm-install-fails-or-npmyarn-is-rejected",children:[(0,i.jsx)(n.code,{children:"pnpm install"})," fails or npm/yarn is rejected"]}),"\n",(0,i.jsxs)(n.p,{children:["The repo enforces pnpm via a ",(0,i.jsx)(n.code,{children:"preinstall"})," script. Using ",(0,i.jsx)(n.code,{children:"npm install"})," or ",(0,i.jsx)(n.code,{children:"yarn install"})," will fail on purpose."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Install pnpm: ",(0,i.jsx)(n.code,{children:"npm install -g pnpm"})," (or see ",(0,i.jsx)(n.a,{href:"https://pnpm.io/",children:"pnpm.io"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:["Verify Node version is 18+: ",(0,i.jsx)(n.code,{children:"node --version"})]}),"\n",(0,i.jsxs)(n.li,{children:["Run ",(0,i.jsx)(n.code,{children:"pnpm install"})," from the repo root"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"aftman-tools-not-found-after-install",children:"Aftman tools not found after install"}),"\n",(0,i.jsxs)(n.p,{children:["If ",(0,i.jsx)(n.code,{children:"rojo"}),", ",(0,i.jsx)(n.code,{children:"selene"}),", ",(0,i.jsx)(n.code,{children:"stylua"}),", or ",(0,i.jsx)(n.code,{children:"luau-lsp"})," aren't available after running ",(0,i.jsx)(n.code,{children:"aftman install"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Ensure aftman's bin directory is on your ",(0,i.jsx)(n.code,{children:"PATH"}),". See ",(0,i.jsx)(n.a,{href:"https://github.com/LPGhatguy/aftman",children:"aftman's README"})," for platform-specific setup."]}),"\n",(0,i.jsxs)(n.li,{children:["Re-run ",(0,i.jsx)(n.code,{children:"aftman install"})," from the repo root \u2014 it reads ",(0,i.jsx)(n.code,{children:"aftman.toml"})," for tool versions."]}),"\n",(0,i.jsxs)(n.li,{children:["On first install, you may need to restart your shell for ",(0,i.jsx)(n.code,{children:"PATH"})," changes to take effect."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"luau-lsp-not-working-in-vs-code",children:"Luau-LSP not working in VS Code"}),"\n",(0,i.jsx)(n.p,{children:"Nevermore uses a forked luau-lsp. The standard extension works, but you must point it at the custom binary:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Run ",(0,i.jsx)(n.code,{children:"aftman install"})," to get the fork"]}),"\n",(0,i.jsxs)(n.li,{children:["In VS Code settings, set ",(0,i.jsx)(n.code,{children:"luau-lsp.server.path"})," to your aftman-installed binary (see ",(0,i.jsx)(n.code,{children:"docs/ides/vscode.md"}),")"]}),"\n",(0,i.jsx)(n.li,{children:"Restart VS Code after changing the setting"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"linting",children:"Linting"}),"\n",(0,i.jsxs)(n.h3,{id:"lintluau-errors-about-missing-sourcemap",children:[(0,i.jsx)(n.code,{children:"lint:luau"})," errors about missing sourcemap"]}),"\n",(0,i.jsxs)(n.p,{children:["The luau type checker needs a sourcemap to resolve module paths. ",(0,i.jsx)(n.code,{children:"npm run lint:luau"})," auto-runs ",(0,i.jsx)(n.code,{children:"build:sourcemap"})," via its ",(0,i.jsx)(n.code,{children:"prelint:luau"}),' script, so this usually "just works". If it fails:']}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Run ",(0,i.jsx)(n.code,{children:"npm run build:sourcemap"})," manually and check for errors"]}),"\n",(0,i.jsx)(n.li,{children:"Ensure Rojo is installed via aftman (the sourcemap is built with Rojo)"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"linting-hangs-or-uses-excessive-memory",children:"Linting hangs or uses excessive memory"}),"\n",(0,i.jsxs)(n.p,{children:["Linters traverse symlinks infinitely if run repo-wide. They must run per-package via ",(0,i.jsx)(n.code,{children:"npx lerna exec --parallel"}),". The ",(0,i.jsx)(n.code,{children:"npm run lint:*"})," scripts in the root ",(0,i.jsx)(n.code,{children:"package.json"})," handle this \u2014 don't run selene, moonwave-extractor, or similar tools directly at the repo root."]}),"\n",(0,i.jsx)(n.h2,{id:"testing",children:"Testing"}),"\n",(0,i.jsx)(n.h3,{id:"cloud-tests-fail-with-authentication-errors",children:"Cloud tests fail with authentication errors"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"nevermore test --cloud"})," needs a Roblox Open Cloud API key. Credential resolution order:"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"--api-key"})," CLI flag"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ROBLOX_OPEN_CLOUD_API_KEY"})," environment variable"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:".env"})," file in the package directory"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["See ",(0,i.jsx)(n.code,{children:"docs/testing/testing.md"})," for full credential documentation."]}),"\n",(0,i.jsx)(n.h3,{id:"tests-pass-locally-but-fail-in-ci",children:"Tests pass locally but fail in CI"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["CI uses the same ",(0,i.jsx)(n.code,{children:"nevermore test --cloud"})," path. Check that ",(0,i.jsx)(n.code,{children:"deploy.nevermore.json"})," has the correct ",(0,i.jsx)(n.code,{children:"universeId"})," and ",(0,i.jsx)(n.code,{children:"placeId"}),"."]}),"\n",(0,i.jsx)(n.li,{children:"Look at the CI job summary for sourcemap-resolved failure annotations."}),"\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"--script-text"})," flag can help debug: ",(0,i.jsx)(n.code,{children:"nevermore test --cloud --script-text 'print(workspace:GetChildren())'"})]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"rojo",children:"Rojo"}),"\n",(0,i.jsx)(n.h3,{id:"rojo-build-errors-or-missing-modules",children:"Rojo build errors or missing modules"}),"\n",(0,i.jsxs)(n.p,{children:["Nevermore uses a custom Rojo fork that understands symlinks (installed via aftman). Standard Rojo won't resolve the monorepo's symlinked ",(0,i.jsx)(n.code,{children:"node_modules"})," correctly."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Verify you're using the forked version: check ",(0,i.jsx)(n.code,{children:"aftman.toml"})," for the Rojo entry"]}),"\n",(0,i.jsxs)(n.li,{children:["If modules are missing, run ",(0,i.jsx)(n.code,{children:"pnpm install"})," first \u2014 Rojo resolves paths through npm's dependency tree"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>t});var o=s(96540);const i={},r=o.createContext(i);function l(e){const n=o.useContext(r);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),o.createElement(r.Provider,{value:n},e.children)}}}]);